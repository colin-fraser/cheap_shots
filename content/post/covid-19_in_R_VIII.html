---
title: "COVID-19 and R Part VIII"
author: "Drew Tyre"
date: "2020-03-20"
output:
  word_document: default
  html_document:
    code_folding: hide
draft: no
slug: COVID-19_and_R_VIII
tags_include:
- R
- OPD
- COVID19
categories: Research
og_image: /post/covid-19_in_r_viii_files/figure-html/featured_image-1.png
---



<p>New cases in the USA took a big jump up yesterday. Italy continues to add more cases per day
than 20 times their ICU capacity. US states and Canadian provinces with the largest number
of cases so far are seeing new cases per day consistent with the exponential model.</p>
<p><a href="/post/covid-19_and_r/">The first post in this series was just over a week ago</a>, in case you’re just joining and
want to see the progression.</p>
<div id="the-bottom-line" class="section level1">
<h1>The bottom line</h1>
<p>DISCLAIMER: These unofficial results are not peer reviewed, and should not be
treated as such. My goal is to learn about forecasting in real time,
how simple models compare with more complex models, and even how to compare
different models.</p>
<p>The figure below is complex, so I’ll highlight some
features first. The y axis is now cases / 100,000 population to make it easier to compare Italy
and the USA. The SOLID LINES are exponential growth models that assume
the rate of increase is <em>constant</em>. The dashed lines are predictions from that
model. To make comparison easier, the estimated model and predictions for both countries are on both panels.
The lines and intervals for the other country are faded out. The horizontal DOTTED LINES
are 20 times the number of ICU beds per 100,000 population in each country. Note that
the y axis is logarithmic.</p>
<p><img src="/post/covid-19_in_R_VIII_files/figure-html/base_image-1.png" width="672" /></p>
<p><a href="/post/covid-19_and_r_vii/">Unlike yesterday</a>, new cases in the USA took a big jump up, but are still inside the prediction interval<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. That jump up has multiple alternative explanations besides an increase in the
actual number of cases. Yesterday’s number was low, so it could be that reporting glitches delayed some
cases from wednesday to thursday. The USA is also trying to increase the rate of testing, with varying levels
of success, so if testing has started to step up the number of reported cases could rise just due to that. Or
both of those things could be happening, on top of an increase in the number of true cases.</p>
<p>Bit of perspective on the testing issue – <a href="https://www.mercurynews.com/2020/03/19/gov-newsom-expands-bay-area-shelter-in-place-to-all-of-california/">apparently California has tested 17000 people so far, and 10000 of those
tests are still pending</a>.</p>
<p>Italy’s numbers continue the linear pattern that started around March 12 – they are going along at a constant
level, a flat line on this graph. Each day Italy adds about the same number of cases as
the day before. This is what “Flattening the curve” looks like. Unfortunately that is still more cases per day than their health care infrastructure can
handle. To put those numbers in perspective, the latest point from italy is
880 cases / 100,000 population. That’s nearly 1%. New cases in Italy are nearly 1% of the population <em>per day</em>.</p>
<p>Below are the same calculations but focused in on 3 US states and 3 Canadian provinces<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.
Each panel has the same features as the graph above.</p>
<p><img src="/post/covid-19_in_R_VIII_files/figure-html/featured_image-1.png" width="672" /></p>
<p>Washington, New York, and British Columbia are near or over the estimated per capita supply of ICU beds. The
projections are two weeks past the end of the window I used to fit the models; those forecasts indicate that
all six locales could be in trouble by the end of the month. If efforts to reduce transmission came too late,
New York could be seeing 10000 cases per day by the end of the month.
<a href="https://www.thecut.com/2020/03/coronavirus-pandemic-what-a-nyc-doctor-is-seeing-in-the-er.html">This interview with an ER doctor in New York City</a>
suggests they are already running out of critical equipment like ventilators and personal protective equipment.
Masks. Because there are not enough protective masks frontline healthcare workers are being exposed
unnecessarily. When all the doctors and nurses are sick who looks after them?</p>
<p>Many models can be
consistent with exponential growth at the beginning of a growth curve,
but do a lousy job of forecasting (for example, <a href="/post/covid-19_and_R_v/">the logistic model</a> scroll down).
Honestly, I’ve
been hoping the exponential model would become invalid in the USA and Canada. That would indicate
that efforts to reduce transmission were working. But there is no sign of that yet.
It’s also true that the forecasts here have a large amount of uncertainty – the forecast incident cases in
Ontario for March 30 span 3 orders of magnitude, between 100 and 10000 new cases.
However that is the worst case, caused by the
large day to day fluctuations in reported cases in Ontario. There is no guarantee that
the exponential model will falsely appear to work just because of this uncertainty. Look at the plot for Italy.
It was clear on March 13 that the exponential model was no longer valid in Italy.</p>
<p>Apparently, somewhere, there are people chanting “Colorado!”, “Nebraska!”. And I happen
to know someone is paying attention in Missouri. So, due to popular demand:</p>
<p><img src="/post/covid-19_in_R_VIII_files/figure-html/cone-1.png" width="672" /></p>
<p>The Colorado and Nebraska regressions are not statistically significant.
In Nebraska that line is very encouraging. We have
already put in place measures to reduce transmission rates, so maybe that will be early
enough to blunt the epidemic
here. Colorado is clearly farther along, and with a few more observations that regression will be significant.
Missouri is interesting because the epidemic started a few days later, but the rate of increase is much
faster. Maybe there is better testing availability in Missouri? The uncertainty in the projections is still
huge, so too early to say much of anything.</p>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>I think this will be my last post for a while. I’ve learned a ton, but trying to keep on top
of the scientific literature and news posts, and hours of hard thinking about code each day is wearing me
out. I’m also emotionally wrung out; it’s like watching a train wreck in slow motion. Too big to do anything
about but the outcome is all too clear. I was in tears after reading the piece about the ER doc in New York.
They can see it coming too. Here are my lessons learned</p>
<ul>
<li><p>Simple models can be useful for decision making. I was already convinced of this, and
this confirmed my belief. If I’d thought to do it, I could have predicted the
ICU crunch in New York 2 weeks ago.</p></li>
<li><p>Open source science can work! The open <a href="https://github.com/CSSEGISandData/COVID-19">John Hopkins University data aggregation</a> is now the de facto go to for everyone, even the US government<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p></li>
</ul>
<p>If anyone wants an up to date figure for some state/province/country shoot me an email and I’ll see what
I can do. Stay safe everyone, wash your hands, go for a walk.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Code not shown in the post can be found <a href="https://raw.githubusercontent.com/rbind/cheap_shots/master/content/post/covid-19_in_R_VII.Rmd">on Github</a>.
This post benefited from comments by Ramona Sky, Kelly Helm Smith, and Jessica Burnett.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Full disclosure: I’m Canadian!<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>A news article I looked at yesterday had a picture of the Department of Health
and Human Services situation room in DC. The <a href="">JHU dashboard</a> was on the wallscreen in the background.<a href="#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
